### dssm
## dependency
- tensorflow(1.2.0)
### how to use (эмбеддинги)
- mkdir model
- in dir model create file 'vocab.txt'
- mkdir output
- cd preprocess
- python preprocess.py
- cd src/run
- python train.py
- python test.py
#### <b style='color:blue'>DONE</b>, всё работает, есть результат
### how to use w2v
- в файле preprocess.py есть generate_vocab(), который ОТКРЫВАЕТ файл vec.txt, НО НЕ СОЗДАЁТ ЕГО.
- в файле dssm.py есть флаг fine_tune, заменить на True, тогда будет v2w вместо эмбеддингов
- в dssm.py есть метод load_w2v(), который считывает из vec.txt
### w2v troubles
- проблемы с созданием vec.txt. есть ощущение, что перепутаны файлы vec.txt и w2v_corpus.txt, потому что w2v_corpus.txt создаётся и никак не используется. <b style='color:blue'>DONE</b>
- lhs shape= [1952,200] rhs shape= [2278,200]. <b style='color:red'>¯\_(ツ)_/¯</b>

#### w2v troubles, разбор чужого кода
- файл vec.txt, который нигде не создаётся, но оттуда считывается в разных местах. какова была задумка автора? надо воссоздать этот файл.
  - во-первых, везде, где с vec.txt считываются данные, пишется: size = int(первая_строка_распарсенная_через_" "[0]), dim = int(первая_строка_распарсенная_через_" "[1]). это значит, что в первой строке файла vec.txt должны быть размер (какой размер? видимо, длина словаря) и размерность (опять же, что за размерность, у автора написано "the dim of the fusion of multi word2vec model") файла, записанные через пробел. видимо, для удобства.
  - dim должна быть равна expectDim, а expectDim у автора 200
- ВЫВОД: надо воссоздать vec.txt. каким образом:
  - преобразуем файл w2v_corpus.txt (или какой-то другой, но этот нигде не используется, значит может быть это оно), который состоит из просто подряд записанных предложений, в файл w2v, причём в его первой строке должны быть dim и size, а dim должно быть 200 (ну или около того, тогда исправить флаг).

#### w2v troubles, разбор чужого кода, part 2
- создала файл vec.txt, функция load_w2v() теперь работает ОК
- НО теперь где-то вектор не того размера. lhs shape= [1952,200] rhs shape= [2278,200]

#### w2v troubles, разбор чужого кода, part 3
- нужно было в качестве исходника для vec.txt использовать vocab.txt
- всё работает и тренится, <b style='color:blue'>DONE</b>

### how to use OUTPUT
- на выходе два файла: diff1.txt и test1.txt, которые получаются при помощи функций write_result и write_diff.
  - про функцию write_result:
    - сначала грузим запросы с помощью функции load_file_data() (просто считывает построчно данные и возвращает список)
    - затем грузим документы с помощью той же функции
    - затем вызываем pred(), который у нас тоже описан, он возвращает предикты по всем запросам и документам
    - в файл test1.txt пишем следующее: query[i] + doc[i] + pred[i]
  - про функцию write_diff:
    - первые три пункта такие же
    - label получаются из load_label_data(). Лейблы бывают 0  или 1
    - в файл diff1.txt пишем ТОЛЬКО ЕСЛИ pred[i] != label[i]
    - если уловие выше выполнено, то пишем query[i] + doc[i] + pred[i] + label[i]
    
